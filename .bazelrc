# Build with C++20 (required by xtensor 0.27+)
build --cxxopt=-std=c++20
build --host_cxxopt=-std=c++20

# Show test output on failure
test --test_output=errors

# Enable bzlmod
common --enable_bzlmod

# Use BSD tools on macOS (GNU coreutils chmod is incompatible with rules_python)
build --repo_env=PATH=/usr/bin:/bin:/usr/sbin:/sbin

# Platform-specific configs
build:macos --cxxopt=-stdlib=libc++
build:macos --host_cxxopt=-stdlib=libc++
build:macos --copt=-mmacosx-version-min=10.13
build:macos --host_copt=-mmacosx-version-min=10.13
build:macos --linkopt=-mmacosx-version-min=10.13

# WASM configuration
build:wasm --crosstool_top=@emsdk//emscripten_toolchain:everything
build:wasm --cpu=wasm
build:wasm --host_crosstool_top=@bazel_tools//tools/cpp:toolchain
